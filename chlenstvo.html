<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96">
  <title>Кандидатстване — Клуб „Туристически свят“</title>
  <style>
    :root{
      --bg:#f6f9fc; --text:#13233a; --muted:#5e6b7a;
      --card:#ffffff; --border:#e7edf3;
      --accent:#2f7d32; --accent-2:#2d7ff2; --danger:#d64242;
      --ring:0 0 0 3px rgba(45,127,242,.25);
      --shadow:0 10px 30px rgba(18, 38, 60, .08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(60rem 60rem at -10% -10%, #e8f1ff 0%, transparent 50%),
        radial-gradient(50rem 50rem at 110% 0%, #e7ffe9 0%, transparent 55%),
        var(--bg);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:28px 16px 80px}
    header{display:flex; align-items:center; gap:14px; margin:4px 0 18px}
    .logo{
      width:56px; height:56px; border-radius:14px; overflow:hidden;
      display:grid; place-items:center; background:#fff; border:1px solid var(--border); box-shadow:var(--shadow);
    }
    h1{margin:0; font-size:clamp(22px,3.2vw,34px)}
    p.lead{margin:6px 0 0; color:var(--muted); font-size:clamp(.95rem,1.5vw,1rem)}
    .btn{
      appearance:none; border:0; padding:12px 18px; border-radius:14px; font-weight:700; cursor:pointer;
      background:linear-gradient(135deg,var(--accent-2),#5aa4ff); color:#fff; box-shadow:var(--shadow);
      transition:transform .05s ease, filter .2s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn.secondary{
      background:linear-gradient(135deg,#eef3f9,#e5eefc); color:#113;
      border:1px solid var(--border);
    }

    footer{margin-top:28px; color:var(--muted); font-size:.92rem}

    /* ===== Modal (popup) ===== */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(7,18,38,.35);
      backdrop-filter:blur(3px);
      display:none; align-items:center; justify-content:center; padding:16px;
      z-index:1000;
    }
    .modal-backdrop[aria-hidden="false"]{display:flex; animation:fadeIn .15s both}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}

    .modal{
      width:min(900px,100%); max-height:min(92vh,1000px);
      background:var(--card); border:1px solid var(--border);
      border-radius:20px; box-shadow:0 30px 60px rgba(16,36,58,.15);
      overflow:hidden; display:flex; flex-direction:column;
      transform:translateY(8px); animation:slideUp .18s ease-out both;
    }
    @keyframes slideUp{from{opacity:.96; transform:translateY(12px)}to{opacity:1; transform:translateY(0)}}

    .modal-header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:12px 14px; border-bottom:1px solid var(--border);
      background:linear-gradient(180deg,#f9fbff, #fff);
    }
    .modal-title{
      display:flex; align-items:center; gap:10px; font-weight:800; font-size:1.06rem;
    }
    .modal-title img{width:32px; height:32px}
    .modal-body{
      padding:18px; overflow:auto; overscroll-behavior:contain;
      scrollbar-width:none;
      background:
        radial-gradient(40rem 40rem at 120% -10%, rgba(45,127,242,.06), transparent 60%),
        radial-gradient(40rem 40rem at -20% 110%, rgba(47,125,50,.06), transparent 60%),
        #fff;
    }
    .modal-body::-webkit-scrollbar{width:0; height:0}
    .close-x{
      appearance:none; border:1px solid var(--border); background:#fff;
      color:#0f1b2e; border-radius:10px; padding:8px 10px; cursor:pointer;
      box-shadow:var(--shadow);
    }

    /* ===== Form ===== */
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    .full{grid-column:1/-1}
    label{display:block; font-weight:700; margin:8px 0 6px}
    .required::after{content:" *"; color:#c98700; font-weight:900}
    input[type=text],input[type=email],input[type=tel],input[type=date],select,textarea{
      width:100%; padding:12px; border-radius:12px; border:1px solid var(--border); background:#fff; color:var(--text);
      outline:none; transition:box-shadow .15s,border-color .15s;
      box-shadow:inset 0 1px 0 rgba(8,20,40,.03);
    }
    input:focus, select:focus, textarea:focus{box-shadow:var(--ring); border-color:#bcd6ff}
    textarea{min-height:110px; resize:vertical}
    .hint{color:var(--muted); font-size:.92rem}
    .chk{display:flex; align-items:flex-start; gap:10px; padding:12px; border:1px solid var(--border); border-radius:12px; background:#fbfdff}
    .bar{height:1px; background:linear-gradient(90deg,rgba(45,127,242,.35),rgba(47,125,50,.35)); margin:16px 0}
    .actions{display:flex; gap:12px; flex-wrap:wrap; align-items:center}

    .success,.error{
      display:none; margin-top:12px; padding:12px 14px; border-radius:12px; font-weight:700
    }
    .success{background:#eaf8ee; color:#206b32; border:1px solid #ccefd6}
    .error{background:#ffefef; color:#7a1f1f; border:1px solid #f3c8c8}

    /* ===== Responsive ===== */
    @media (max-width:840px){ .grid{grid-template-columns:1fr} .modal-title{font-size:1rem} }
    @media (hover:hover){ .btn:hover{filter:brightness(1.03)} }
  </style>
</head>
<body>
  <div class="wrap" aria-hidden="false">
    <header>
      <div class="logo">
        <img src="favicon-96x96.png" alt="Лого на Клуб „Туристически свят“" width="48" height="48" loading="eager" decoding="async">
      </div>
      <div>
        <h1>Клуб „Туристически свят“</h1>
        <p class="lead">Добре дошли в страницата на клуб "Туристически свят" - Самоков.</p>
      </div>
    </header>

    <button class="btn" id="openModalBtn">Кандидатствай за членство</button>
    <p class="lead" style="margin-top:12px">Попълнете онлайн заявката и ние ще се свържем с Вас. Всички полета са задължителни!.</p>

    <footer>© <span id="year"></span> Клуб „Туристически свят“</footer>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal" role="document">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">
          <img src="favicon-96x96.png" alt="" aria-hidden="true">
          <span>Кандидатстване за членство</span>
        </div>
        <button class="close-x" id="closeModalBtn" aria-label="Затвори (Esc)">✕</button>
      </div>
      <div class="modal-body">
        <!-- ВАЖНО: FormSubmit.co -->
        <form id="membershipForm"
              action="https://formsubmit.co/uzunov.ange@gmail.com"
              method="POST" enctype="multipart/form-data" novalidate>

          <!-- FormSubmit.co скрити полета -->
          <input type="hidden" name="_subject" value="Нова кандидатура — Клуб „Туристически свят“">
          <input type="hidden" name="_template" value="box">
          <input type="hidden" name="_captcha" value="false">
          <input type="text"   name="_honey" style="display:none" tabindex="-1" autocomplete="off">

          <div class="grid">
            <div>
              <label for="fname" class="required">Име</label>
              <input id="fname" name="first_name" type="text" required placeholder="Иван">
            </div>
            <div>
              <label for="lname" class="required">Фамилия</label>
              <input id="lname" name="last_name" type="text" required placeholder="Иванов">
            </div>

            <div>
              <label for="email" class="required">Имейл</label>
              <input id="email" name="email" type="email" required placeholder="name@example.com" inputmode="email" autocomplete="email">
            </div>
            <div>
              <label for="phone" class="required">Телефон</label>
              <input id="phone" name="phone" type="tel" required placeholder="+359 88 123 4567" inputmode="tel" pattern="^[0-9+() -]{7,}$" autocomplete="tel">
              <div class="hint">Номер за връзка при промени в графика.</div>
            </div>

            <div class="full">
              <label for="address" class="required">Адрес (град, улица/кв.)</label>
              <input id="address" name="address" type="text" required placeholder="гр. София, кв. ...">
            </div>

            <div>
              <label for="birthdate" class="required">Дата на раждане</label>
              <input id="birthdate" name="birthdate" type="date" required>
            </div>
            <div>
              <label for="idnum">Личен № (по желание)</label>
              <input id="idnum" name="id_number" type="text" placeholder="(незадължително)">
            </div>

            <div>
              <label for="experience" class="required">Опит в пешеходния туризъм</label>
              <select id="experience" name="hiking_experience" required>
                <option value="" selected disabled>— изберете —</option>
                <option>Начинаещ</option>
                <option>Средно напреднал</option>
                <option>Напреднал</option>
                <option>Планински водач</option>
              </select>
            </div>

            <div>
              <label for="terrain">Любими планини/маршрути</label>
              <input id="terrain" name="favorite_areas" type="text" placeholder="Рила, Пирин, Стара планина…">
            </div>

            <div class="full">
              <label for="motivation" class="required">Мотивация за членство</label>
              <textarea id="motivation" name="motivation" required placeholder="Защо искаш да се присъединиш?"></textarea>
            </div>

            <div class="full">
              <label for="medical">Медицински състояния/алергии</label>
              <textarea id="medical" name="medical_info" placeholder="Сподели важна информация за безопасност (ако има)."></textarea>
            </div>

            <div>
              <label for="membership" class="required">Тип членство</label>
              <select id="membership" name="membership_type" required>
                <option value="" selected disabled>— изберете —</option>
                <option>Редовен член</option>
                <option>Студент/ученик</option>
                <option>Семейно</option>
                <option>Подкрепящ (без участие в походи)</option>
              </select>
            </div>

            <div>
              <label for="comm">Предпочитан контакт</label>
              <select id="comm" name="preferred_contact">
                <option>Имейл</option>
                <option>Телефон</option>
                <option>Viber/WhatsApp</option>
              </select>
            </div>

            <div class="full">
              <label for="emg_name" class="required">Спешен контакт — име</label>
              <input id="emg_name" name="emergency_name" type="text" required placeholder="Майка/баща/приятел…">
            </div>
            <div>
              <label for="emg_phone" class="required">Спешен контакт — телефон</label>
              <input id="emg_phone" name="emergency_phone" type="tel" required placeholder="+359 ..." pattern="^[0-9+() -]{7,}$">
            </div>
            <div>
              <label for="emg_relation" class="required">Родство</label>
              <input id="emg_relation" name="emergency_relation" type="text" required placeholder="напр. майка, съпруг/а, приятел">
            </div>

            <div class="full">
              <label for="insurance">Планинска застраховка (файл, ако имате)</label>
              <input id="insurance" name="attachments" type="file" accept=".jpg,.jpeg,.png,.pdf">
              <div class="hint">Може да приложите снимка или PDF.</div>
            </div>

            <div class="full">
              <label for="photo">Снимка за клубна карта (по желание)</label>
              <input id="photo" name="attachments" type="file" accept=".jpg,.jpeg,.png">
            </div>

            <div>
              <label for="date" class="required">Дата на подаване</label>
              <input id="date" name="submit_date" type="date" required>
            </div>
            <div>
              <label for="signature" class="required">Подпис (име и фамилия)</label>
              <input id="signature" name="typed_signature" type="text" required placeholder="Име Фамилия">
            </div>

            <div class="full chk">
              <input id="agree_rules" name="agree_rules" type="checkbox" required>
              <label for="agree_rules" class="required">Приемам <a href="https://turistibg.weebly.com/1055105610401042104810511040.html" target="_blank" rel="noopener">Общите условия</a> и правилника на клуба.</label>
            </div>

            <div class="full chk">
              <input id="gdpr" name="gdpr" type="checkbox" required>
              <label for="gdpr" class="required">Съгласявам се личните ми данни да бъдат обработвани за целите на членството (GDPR).</label>
            </div>

            <div class="full chk">
              <input id="newsletter" name="newsletter" type="checkbox">
              <label for="newsletter">Желая да получавам имейл известия за походи и събития.</label>
            </div>
          </div>

          <div class="bar"></div>

          <div class="actions">
            <button class="btn" type="submit">Изпрати кандидатура</button>
            <button class="btn secondary" type="button" id="closeFromForm">Затвори</button>
            <span class="hint">Ще получите потвърждение по имейл след обработка.</span>
          </div>

          <div class="success" id="successNote">✅ Изпратено успешно.</div>
          <div class="error" id="errorNote">❌ Възникна проблем. Проверете полетата.</div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Година и дата
    (function(){
      const today = new Date().toISOString().slice(0,10);
      const dateSetter = () => {
        const dateInput = document.getElementById('date');
        if(dateInput && !dateInput.value){ dateInput.value = today; }
      };
      window.addEventListener('DOMContentLoaded', dateSetter);
      document.getElementById('year').textContent = new Date().getFullYear();
    })();

    // ===== Modal controls + scroll lock =====
    const openBtn = document.getElementById('openModalBtn');
    const backdrop = document.getElementById('modalBackdrop');
    const closeBtn = document.getElementById('closeModalBtn');
    const closeFromFormBtn = document.getElementById('closeFromForm');

    function lockScroll(){ document.body.style.overflow='hidden'; document.body.addEventListener('touchmove', prevent, {passive:false}); }
    function unlockScroll(){ document.body.style.overflow=''; document.body.removeEventListener('touchmove', prevent); }
    function prevent(e){ e.preventDefault(); }

    function openModal(){
      backdrop.setAttribute('aria-hidden','false');
      lockScroll();
      setTimeout(()=> document.getElementById('fname')?.focus(), 60);
    }
    function closeModal(){
      backdrop.setAttribute('aria-hidden','true');
      unlockScroll();
      openBtn?.focus();
    }

    openBtn.addEventListener('click', openModal);
    closeBtn.addEventListener('click', closeModal);
    closeFromFormBtn.addEventListener('click', closeModal);
    backdrop.addEventListener('click', (e)=>{ if(e.target === backdrop){ closeModal(); } });
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && backdrop.getAttribute('aria-hidden')==='false'){ closeModal(); } });

    // Авто-отваряне при #apply (по желание)
    if(location.hash === '#apply'){ openModal(); }

    // ===== Form validation & redirect =====
    const form = document.getElementById('membershipForm');
    const successNote = document.getElementById('successNote');
    const errorNote = document.getElementById('errorNote');

    const show = el => el.style.display='block';
    const hide = el => el.style.display='none';

    form.addEventListener('submit', function(e){
      hide(successNote); hide(errorNote);
      if(!form.checkValidity()){
        e.preventDefault(); show(errorNote); form.reportValidity(); return;
      }
      const digits = s => String(s||'').replace(/[^\d]/g,'').length;
      if(digits(document.getElementById('phone').value) < 7 || digits(document.getElementById('emg_phone').value) < 7){
        e.preventDefault(); show(errorNote);
        alert('Моля, въведете валиден телефон (минимум 7 цифри) за вас и спешния контакт.');
        return;
      }
      // Абсолютен redirect за FormSubmit.co
      const next = document.createElement('input');
      next.type='hidden'; next.name='_next';
      next.value = `${location.origin}${location.pathname}#ok`;
      form.appendChild(next);
    });

    if(location.hash === '#ok'){
      openModal(); show(successNote);
      const body = document.querySelector('.modal-body'); body?.scrollTo({top:0, behavior:'instant'});
    }
  </script>
</body>
</html>
